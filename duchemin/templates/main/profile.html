<!--  RF MAY 2014:  This file INCLUDES changes from Portier Branch.  AH:  Please review logic for My Work/My Favorites/ My Discussions -->
{% extends "base.html" %}

{% block header %}
  <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/themes/base/jquery-ui.css" rel="stylesheet"></link>
  <script src="{{ STATIC_URL }}js/notation.js"></script>
  <script type="text/javascript" src="http://vm-duchemin.haverford.edu:8080/assets/scripts/libs/vexflow-free.js"></script>
  <script type="text/javascript" src="http://vm-duchemin.haverford.edu:8080/assets/scripts/libs/meitovexflow.js"></script>
<script type="text/javascript">
    $(document).ready(function (){
        attachAnalysisClickEvents();
    });
  </script>
{% endblock %}

{% block wrap %}
  <div class="row-fluid">
    <div class="span12">
      <div class="account-heading row-fluid">
        <hgroup class="account-title page-title span8">
          <h1>Account Profile</h1>
          <h2>{{ user.first_name}} {{ user.last_name }}</h2>
          <h3>{{ user.username }}</h3>
        </hgroup>
        <div class="well span4">
          <dl class="well-list account-info-list">
            <dt>Joined:</dt>
            <dd>{{ user.date_joined }}</dd>
            <dt>Role:</dt>
            <dd>{{ user.role }}</dd>
          </dl>
        </div>
      </div>
      <div class="row-fluid">
        <div class="span8 favorites-container content-container">
          <!-- RF May 2014:  Tab Titles OK-->
            <ul class="nav nav-tabs">
              <li class="active"><a href="#tab1" data-toggle="tab">My Work</a></li>
              <li><a href="#tab2" data-toggle="tab">My Favorites</a></li>
              <li><a href="#tab3" data-toggle="tab">My Discussions</a></li>
            </ul>
            <!--  RF May 2014:  "My Work" section for Observations and Reconstructions CREATED by this user -->
             <div class="tab-pane active" id="tab1">        
                <div id="search-accordion">
                 <div class="accordion-group">
                  <div class="accordion-heading">
                <!--RF May 2014: #MyObservations, not MyPieces -->
                   <a class="accordion-toggle" id="sidebar-accordian" data-toggle="collapse" href="#mypieces-section">
                   <!--RF May 2014: Observations = Analyses CREATED by this user -->
                   <h2>Observations<i class="icon-minus" id="toggle"></i></h2></a>
                  </div>
                  <div id="mypieces-section" class="accordion-body in collapse">
                   <div class="accordion-inner">
                    <table class="table table-striped table-bordered table-hover">
                      <tr>
                      <!--RF May 2014: Observations here corresponds to each user's "analyses"  AH Please add required models and fields. -->
                       <th>Piece</th>""
                       <th>Title</th>
                       <th>Observation</th>
                      </tr>
                      <tr>
                       <td><a href="#piece">DC0101</a></td>
                        <td><a href="#title">Qui souhaitez avoir tout le plaisir</a></td>
                        <td><a href="#analysis">Analysis 1200</a></td>
                      </tr>
                   </table>
                   </div>
                  </div>
                 </div>
                </div>
            <div class="spacerTop"></div>
                
                <!-- RF May 2014.  Reconstructions section lists Recons CREATED by this user.  AH please add required fields. -->
                <div id="search-accordion">
                 <div class="accordion-group">
                  <div class="accordion-heading">
                   <a class="accordion-toggle" id="sidebar-accordian" data-toggle="collapse" href="#myreconstructions-section">
                   <h2>Reconstructions<i class="icon-plus" id="toggle"></i></h2></a>
                  </div>
                  <div id="myreconstructions-section" class="accordion-body collapse">
                   <div class="accordion-inner">
                        <!--RF May 2014: "Add New Recon" button has been deleted, since this will take place via Project Team-->
                    <table id="reconstructions" class="table table-striped table-bordered table-hover">
                    <thead>
                    <tr>
                       <th>Piece</th>
                       <th>Title</th>
                      </tr>
                      </thead>
                <!--RF May 2014: Here are Reconstructions created by this user. -->
                      <tbody>
                      <tr>
                        <td><a href="#piece">DC1217</a></td>
                        <td><a href="#title">Amour a faict ce qu&#39;il ne peut deffaire<</a></td>
                        </tr>
                    </tbody>
                    </table>
                   </div>
                  </div>
                 </div>
                </div>
                
              </div>
            <!-- RF May 2014.  This is for "My Favorites".  AH:  Line 106 should be "tab2" YES?-->
            <div class="tab-content">
              <div class="tab-pane active" id="tab2">
                <!-- RF May 14:  First:  My Favorite Pieces-->
                <h2>Pieces</h2>
                <div id="favpieces-section" class="accordion-body in collapse">
                    <div class="accordion-inner">
                      {% if profile.favourited_piece.count > 0 %}
                        <table class="table table-striped table-bordered table-hover">
                          <tr>
                          <th>Piece</th>
                          <th>Title</th>
                          <th>Notes</th>
                          <th>Delete?</th>
                          </tr>
                          {% for favourite in profile.favourited_piece.iterator %}
                            <tr>
                              <td><a href="{% url 'duchemin.views.main.piece' favourite.piece_id %}">{{ favourite.piece_id }}</a></td>
                              <td>{{ favourite.title }}</td>
                              <td><button class="btn btn-info pull-right"> View/Edit Note </button></td>
                              <td><button class="btn btn-danger pull-right"> Delete? </button></td>
                            </tr>
                          {% endfor %}
                        </table>
                      {% endif %}
                   </div>
                <!--  RF May 2014: This section no longer needed, correct? 
                {% if profile.favourited_piece.count > 0 %}
                <ul>
                  {% for favourite in favourited_pieces %}
                    <li><a href="/piece/{{ favourite.piece_id }}">{{ favourite.title }}</a></li>
                  {% endfor%}
                </ul>
                {% else %}
                <p>You have not selected any favorite pieces</p>
                {% endif %}

                <h2>Observations</h2>
                {% if profile.favourited_analysis.count > 0 %}
                  {% include "analysis/analysis_display_table.html" with analyses=favourited_analyses %}
                {% else %}
                  <p>You have not selected any favorite analyses</p>
                {% endif %}
                -->

                <!-- RF May 2014:  These are My Favorite Reconstructions.  AH:  Check fields/models please.-->
                <h2>Reconstructions</h2>
                <div id="favpieces-section" class="accordion-body in collapse">
                    <div class="accordion-inner">
                      {% if profile.favourited_reconstruction.count > 0 %}
                        <table class="table table-striped table-bordered table-hover">
                          <tr>
                          <th>Piece</th>
                          <th>Title</th>
                          <th>Notes</th>
                          <th>Delete?</th>
                          </tr>
                          {% for favourite in profile.favourited_reconstruction.iterator %}
                            <tr>
                              <td><a href="{% url 'duchemin.views.main.piece' favourite.piece_id %}">{{ favourite.piece.title }} ({{ favourite.reconstructor }})</a></td>
                              <td>{{ favourite.title }}</td>
                              <td><button class="btn btn-info pull-right"> View/Edit Note </button></td>
                              <td><button class="btn btn-danger pull-right"> Delete? </button></td>
                            </tr>
                          {% endfor %}
                        </table>
                      {% endif %}
                   </div>
              <!-- RF May 2014:  The following no longer needed.  AH please confirm.
              <a>  
                   <li>{% if profile.favourited_reconstruction.count > 0 %}
                <ul>
                  {% for favourite in favourited_reconstructions %}
                    <li><a href="/piece/{{ favourite.piece_id }}">{{ favourite.piece.title }} ({{ favourite.reconstructor }})</a></li>
                  {% endfor %}
                </ul>
                {% else %}
                  <p>You have not selected any favorite reconstructions</p>
                {% endif %}
              </div> 
                -->

              <!-- RF May 2014:  The following section not needed.  AH please confirm
              <div class="tab-pane" id="tab2">
                {% if my_analyses %}
                <h2>My Observations</h2>
                {% for analysis in my_analyses %}
                <p>{{ analysis.composition_number.title }}</p>
                {% endfor %}
                {% endif %}
              </div>
              <div class="tab-pane" id="tab3">
              {% if my_reconstructions %}
                <h2>My Reconstructions</h2>
                {% for reconstruction in my_reconstructions %}
                <p><a href="/piece/{{ reconstruction.piece.piece_id }}">{{ reconstruction.piece.title }}</a></p>
                {% endfor %}
              {% endif %}
              </div>
              -->
            <!-- RF May 2014:  Here are My Discussions.  AH:  Logic needed. --></div>
          </div>
        </div><!--/span-->
        
        
        <!-- RF May 2014:  Do we need this sidebar?  We can just explain about Favorites in HELP.  
        <div id="sidebar" class="span4">
          <h3>About Favorites</h3>
          <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
          <p>Donec id elit non mi porta gravida at eget metus. Fusce dapibus, tellus ac cursus commodo, tortor mauris condimentum nibh, ut fermentum massa justo sit amet risus. Etiam porta sem malesuada magna mollis euismod. Donec sed odio dui. </p>
        </div>
        -->
        <!--/span-->
        
        
      </div><!--/row-->
    </div><!--/span-->
  </div><!--/row-->
{% endblock %}
